{"ast":null,"code":"import { inject } from \"@angular/core\";\nimport { AuthService } from \"../services/auth.service\";\nimport { tap } from \"rxjs\";\nexport const JwtInterceptor = (req, next) => {\n  console.log('request', req.method, req.url);\n  const authService = inject(AuthService);\n  const token = authService.getToken();\n  console.log(\"Interceptor działa!\");\n  const currentDate = new Date();\n  if (token) {\n    const expirationDate = new Date(authService.getParsedToken().exp * 1000);\n    console.log(\"Interceptor działa 22!\");\n    if (expirationDate > currentDate) {\n      req = req.clone({\n        setHeaders: {\n          Authorization: `Bearer ${token}`\n        }\n      });\n    } else {\n      authService.logout();\n    }\n  }\n  return next(req).pipe(tap(resp => console.log('response', resp)));\n  ;\n};","map":{"version":3,"names":["inject","AuthService","tap","JwtInterceptor","req","next","console","log","method","url","authService","token","getToken","currentDate","Date","expirationDate","getParsedToken","exp","clone","setHeaders","Authorization","logout","pipe","resp"],"sources":["C:\\Users\\natix\\Desktop\\Nowy folder\\BoardGameApp\\frontend\\src\\app\\interceptors\\jwt.interceptor.ts"],"sourcesContent":["import { HttpInterceptorFn } from \"@angular/common/http\";\nimport { inject} from \"@angular/core\";\nimport { AuthService } from \"../services/auth.service\";\nimport { tap } from \"rxjs\";\n\n\nexport const JwtInterceptor: HttpInterceptorFn = (req, next) => { \n  console.log('request', req.method, req.url);\n  const authService = inject(AuthService);\n  const token = authService.getToken();\n    console.log(\"Interceptor działa!\")\n    const currentDate = new Date();\n    if(token){\n      const expirationDate = new Date(authService.getParsedToken().exp * 1000);\n      console.log(\"Interceptor działa 22!\")\n      if(expirationDate > currentDate){\n        req = req.clone({\n          setHeaders: {\n            Authorization: `Bearer ${token}`\n          }\n        })\n      }\n      else{\n        authService.logout();\n      }\n    }\n    return next(req).pipe(\n      tap(resp => console.log('response', resp))\n    );;\n      \n}\n"],"mappings":"AACA,SAASA,MAAM,QAAO,eAAe;AACrC,SAASC,WAAW,QAAQ,0BAA0B;AACtD,SAASC,GAAG,QAAQ,MAAM;AAG1B,OAAO,MAAMC,cAAc,GAAsBA,CAACC,GAAG,EAAEC,IAAI,KAAI;EAC7DC,OAAO,CAACC,GAAG,CAAC,SAAS,EAAEH,GAAG,CAACI,MAAM,EAAEJ,GAAG,CAACK,GAAG,CAAC;EAC3C,MAAMC,WAAW,GAAGV,MAAM,CAACC,WAAW,CAAC;EACvC,MAAMU,KAAK,GAAGD,WAAW,CAACE,QAAQ,EAAE;EAClCN,OAAO,CAACC,GAAG,CAAC,qBAAqB,CAAC;EAClC,MAAMM,WAAW,GAAG,IAAIC,IAAI,EAAE;EAC9B,IAAGH,KAAK,EAAC;IACP,MAAMI,cAAc,GAAG,IAAID,IAAI,CAACJ,WAAW,CAACM,cAAc,EAAE,CAACC,GAAG,GAAG,IAAI,CAAC;IACxEX,OAAO,CAACC,GAAG,CAAC,wBAAwB,CAAC;IACrC,IAAGQ,cAAc,GAAGF,WAAW,EAAC;MAC9BT,GAAG,GAAGA,GAAG,CAACc,KAAK,CAAC;QACdC,UAAU,EAAE;UACVC,aAAa,EAAE,UAAUT,KAAK;;OAEjC,CAAC;KACH,MACG;MACFD,WAAW,CAACW,MAAM,EAAE;;;EAGxB,OAAOhB,IAAI,CAACD,GAAG,CAAC,CAACkB,IAAI,CACnBpB,GAAG,CAACqB,IAAI,IAAIjB,OAAO,CAACC,GAAG,CAAC,UAAU,EAAEgB,IAAI,CAAC,CAAC,CAC3C;EAAC;AAEN,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}